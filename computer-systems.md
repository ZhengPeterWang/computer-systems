# CS 3410

百年汪大传承知识火炬，造福一代代汪铮人民。

本文档为CS 3410预习的笔记。这门课主要讨论计算机系统的构成，以及处理器、内存和并行是如何工作的。本课程架起了硬件和软件之间的桥梁。

基础计算机可以看成由两个部分组成：内存(memory)和处理器(processor)。Central Processing Unit（CPU）就是现代电脑的处理器，而Random Access Memory(RAM)就是现代电脑的内存。处理器内部也有一些内部存储空间，称为寄存器(register），而处理器就相当于一个图灵机，不停地在不同状态间切换并修改寄存器的值，从而完成计算。内存则提供了远比处理器多的存储空间。两者是通过总线(bus)联系起来的。

为了与硬件交互，我们需要一种把内存和处理器抽象的平台，这样我们就能站在软件的角度理解硬件。这个平台叫指令集架构(Instruction Set Architecture)。

## 第1章 什么是电脑？电脑是怎么工作的？

目前的电脑主要有四种：个人电脑(PC)，服务器(server)，嵌入式微处理器（代表为单片机），和个人移动设备(PMD)。云计算正逐渐替代传统的服务器。

### 1.1 电脑硬件简介

一个计算机主要由五个部分组成：**输入设备**（比如麦克风，键盘，鼠标），**输出设备**（比如音响，显示器，触摸屏），**内存，数据通路**(datapath)和**控制中心**，其中后两个经常并起来称为**处理器**。

#### 输入和输出设备

##### 图形显示

现代电脑是用二进制数字存储图像的。每个图像都被转成RGB格式表示的像素，每个像素都有三个字节，分别表示红色、绿色、黑色。数以万计的像素形成了显示器。现代的显示器大都是液晶显示器，是利用液晶分子通电后会改变其偏振属性，从而改变偏振光光强的方法控制不同单色光强度，从而显示出不同颜色的。现代电脑控制显示图片的工具是帧缓冲器(frame buffer)，需要显示的位图(bit map)先存储到帧缓冲器，再按照刷新速率不断地把信息输送给显示器。

##### 触摸设备

现代移动设备大量采用了电容感应方案。绝缘体玻璃被人体（导体）触摸后会改变屏幕的电场进而改变其电容，从而能够让系统电路获得感应信息。当然键盘等传统的靠压力通断电路开关的触摸设备现仍然大量地在个人电脑中使用。

#### 处理器

处理器又称**中央处理单元**(CPU)，主要包括控制中心和数据通路。数据通路是完成全部计算的主要设备，而控制中心则负责解析需要完成哪些计算。处理器一般被安放在**芯片**(chip)上。我们将在之后的更多章节讨论处理器。

#### 内存

现代的内存主要以**随机存取内存**(RAM)为形式。内存主要有动态随机存储内存（DRAM）和静态随机存储内存（SRAM，又称缓存,cache）。SRAM比DRAM更贵，内存容量更小，但更容易访问。现代电脑运用了多种不同的内存形成一套内存等级，以便最大限度地利用所有资源。

学习之后的课程后就能知道，**临时内存**（volatile memory)主要是通过控制电路某部分电压是否大于阈值来实现的。一旦断电，所有临时内存就都会丢失。因此，还有另一种内存称为**永久内存**(nonvolatile memory)，把信息用物理的方式存起来。临时内存因此又称主内存，而永久内存又称副内存。

永久内存主要有磁盘（magnetic disk，又称硬盘,hard disk, hard drive）和闪存(flash drive)。磁盘由盘片和磁头组成。盘片上布满了磁性物质。当我们向磁盘写信息时，磁头会去改变硬盘上某个位置的磁极。当我们向硬盘读信息时，磁头会去感应硬盘上某个位置的磁阻。为了读写盘片上的某个位置，磁头和盘片必须不停高速旋转以找到其对应的内存，这个过程会散发大量的热。磁盘内部还有一个微处理器，负责把读到的内容传递给数字电路。闪存则用电容存储信息。当闪存中的浮门带电时，闪存就拥有高电压，因此1就会被存储在这个晶体管。

内存全名 | 内存简称 | 存取时间 | 1GB存储的价格（2012）
-|-|-|-
静态随机存取内存 | SRAM | 10ns | ?
动态随机存储内存 | DRAM | 50ns | $5 - $10
磁盘 | 硬盘 | 5 - 20 ms | $0.05 - $0.1
闪存 | flash | 0.1 ms | $1

我们将在之后的更多章节讨论内存，尤其是临时内存。

#### 网络

网络是现代电脑必不可缺的部分。它能够允许信息交互、资源共享、远程控制。网络有两种规模：局域网(local area network, LAN)和广域网(wide area network, WAN)。现代局域网速可以达到1-40GB/s，而通过光纤宽带实现的广域网速业已达到1GB/s。以wifi标准和通信网络为基础的无线网现在成为全新的网络形式，目前一般的网速可以达到100MB/s。

### 1.2 性能

电脑的性能可以用响应时间和数据吞吐量描述。响应时间分为CPU时间和获得内存、IO等的时间，而CPU时间又分为系统CPU时间和用户CPU时间。我们之后主要讨论CPU时间，尤其是用户CPU时间。

决定性能的唯一标准是执行时间，但在不同的CPU上不同的程序执行时间有很大差别。一个程序的执行时间由指令个数、每指令执行的钟表圈数(CPI)、以及单位钟表圈数执行时间决定。

### 1.3 指令集架构（电脑架构）

抽象性原理要求我们在研究更抽象内容时忽略具体实现细节，只需要把更具体的内容封装抽象为一个个模型即可。现代电脑最重要的一个抽象就是硬件与最低级软件之间的交互，这个交互模型称为**指令集架构**(Instruction Set Architecture)，简称**架构**(architecture)。这个抽象的架构是一套规则组成的要求，而具体的硬件应该**实现**这个要求。

电脑是由命令驱动的，而低端的处理器只能懂得二进制信号。为了完成从人类指令到计算机指令的转换，一代代工程师发明了大量的语言。通过汇编语言(assembly language)可以让你输入简单的英语单词就能把它转成二进制信号（机器码,machine code），而高级语言则让你用接近自然语言的方式提出指令，通过编译器或解释器将其转成汇编语言。高级语言可以让思维变得更自然，让指令变得更简洁，同时还能让指令独立于使用的平台，这是抽象性原理的体现。